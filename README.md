# 球搭子网球赛事管理系统

## 项目概述

基于HTML5+CSS3+JavaScript开发的网球赛事管理系统，支持手机端操作和大屏端展示。

## 技术架构

### 前端技术栈
- **核心**: 原生 JavaScript (ES6+)，模块化设计
- **UI**: 自定义响应式组件，适配手机和大屏
- **存储**: localStorage (加密缓存)
- **同步**: localStorage事件 + 轮询机制

### 模块结构
```
js/
├── config.js      # 系统配置
├── utils.js       # 工具函数
├── cache.js       # 缓存模块（加密、同步）
├── auth.js        # 认证模块（登录、注册）
├── scoring.js     # 计分模块（占先/金球、抢七）
├── ranking.js     # 排名模块（平分出线算法）
├── app.js         # 主应用模块
└── display.js     # 大屏展示模块
```

## 核心功能

### 1. 登录模块
- 多用户账号密码登录
- 登录态持久化
- 操作日志区分用户
- 内置测试账号：
  - admin / admin123
  - user1 / user123
  - user2 / user123

### 2. 缓存模块
- localStorage加密缓存
- 多标签页同步
- 断网自动缓存
- 网络恢复自动同步

### 3. 赛事管理
- **新建比赛**: 配置占先/金球、抢七规则
- **报名**: 手动输入选手（支持Excel批量导入扩展）
- **抽签**: 自动均分+手动调整分组
- **积分排名**: 自动计算，多维度排序

### 4. 计分系统
- **占先制**: 40-40后需领先2分
- **金球制**: 40-40时下一分直接决定胜负
- **抢七**: 6-6时自动触发，先到7分且领先2分
- **快捷按钮**: 得分、ACE、OUT、失误、双误、重发
- **撤销功能**: 支持撤销上一步操作

### 5. 平分出线算法
排序优先级：
1. 积分（胜场2分）
2. 局数差（gamesWon - gamesLost）
3. 直胜关系（headToHead）
4. ACE数差
5. 净胜分
6. 人工裁定

### 6. 大屏展示
- 独立页面（display.html）
- 实时同步比分（延迟≤500ms）
- 显示选手姓名、实时比分、抢七/占先状态
- 显示ACE/失误统计
- 支持切换场次、全屏模式

## 使用方法

### 操作端（手机）
1. 打开 `index.html`
2. 使用测试账号登录
3. 创建比赛 → 添加选手 → 抽签分组
4. 录入比分（逐分录入）
5. 查看积分榜和出线情况

### 大屏端
1. 打开 `display.html`
2. 通过URL参数选择场次：`display.html?matchId=xxx`
3. 或点击"切换场次"按钮选择
4. 点击"全屏"按钮进入全屏模式

## 文件说明

- `index.html` - 操作端主页面
- `display.html` - 大屏展示页面
- `style.css` - 样式文件
- `js/config.js` - 系统配置
- `js/utils.js` - 工具函数
- `js/cache.js` - 缓存模块
- `js/auth.js` - 认证模块
- `js/scoring.js` - 计分逻辑
- `js/ranking.js` - 排名算法
- `js/app.js` - 主应用
- `js/display.js` - 大屏展示
- `ARCHITECTURE.md` - 架构设计文档

## 开发计划

### 已完成
- ✅ 模块化架构设计
- ✅ 登录/注册功能
- ✅ 加密缓存模块
- ✅ 占先/金球计分逻辑
- ✅ 抢七计分逻辑
- ✅ 平分出线排序算法
- ✅ 大屏展示页面

### 待完善
- ⏳ 完整的比分录入界面
- ⏳ Excel批量导入
- ⏳ 操作撤销功能
- ⏳ 大屏样式自定义
- ⏳ 后端API集成（未来）

## 注意事项

1. **浏览器兼容性**: 建议使用Chrome、Edge等现代浏览器
2. **存储限制**: localStorage有大小限制（通常5-10MB）
3. **数据安全**: 当前加密为简化版，生产环境应使用Web Crypto API
4. **网络同步**: 当前为前端实现，未来可扩展后端API

## 技术支持

如有问题，请查看浏览器控制台（F12）的错误信息。

