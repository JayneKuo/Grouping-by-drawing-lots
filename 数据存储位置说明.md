# 数据存储位置说明

## 📍 当前数据存储位置

根据代码配置（`src/utils/storage.js`），当前数据保存在：

### 1. **Firebase Firestore**（主要存储）
- **位置**：Google Firebase 云数据库
- **项目ID**：`tennis-tournament-f2e6e`
- **集合名**：`tennis_tournaments`
- **查看方式**：访问 [Firebase Console](https://console.firebase.google.com/project/tennis-tournament-f2e6e/firestore)
- **特点**：
  - ✅ 数据持久化，不会丢失
  - ✅ 多用户实时同步
  - ⚠️ 国内访问可能需要VPN

### 2. **浏览器 localStorage**（本地缓存）
- **位置**：用户浏览器本地存储
- **键名**：`tennis_tournament_data`
- **特点**：
  - ✅ 快速读取
  - ✅ 离线支持
  - ⚠️ 仅限当前浏览器，清除缓存会丢失

---

## 🔄 切换到 Vercel KV（推荐）

如果你想使用 Vercel KV 存储（国内访问更快，无需VPN），按以下步骤操作：

### 步骤1：创建 Vercel KV 数据库

1. 访问 [Vercel Dashboard](https://vercel.com/dashboard)
2. 选择你的项目
3. 进入 **Storage** → **Create Database**
4. 选择 **KV**（Redis）
5. 创建数据库（名称随意，如：`tennis-tournament`）

### 步骤2：配置环境变量

在 Vercel Dashboard → 项目设置 → **Environment Variables** 中添加：

```
KV_REST_API_URL=你的KV数据库URL
KV_REST_API_TOKEN=你的KV数据库Token
```

这些值在 Storage 页面的数据库详情中可以找到。

### 步骤3：修改代码配置

修改 `src/utils/storage.js`：

```javascript
const USE_VERCEL_API = true // 改为 true

// 使用Vercel API
export { storage, syncStatus } from './vercel'

// 注释掉Firebase
// export { storage, syncStatus } from './firebase'
```

### 步骤4：设置 API URL

在项目根目录创建 `.env` 文件（如果还没有）：

```env
VITE_API_URL=https://你的项目域名.vercel.app/api
```

例如：`VITE_API_URL=https://grouping-by-drawing-lots.vercel.app/api`

### 步骤5：提交并重新部署

```bash
git add src/utils/storage.js .env
git commit -m "feat: 切换到Vercel KV存储"
git push
```

Vercel 会自动重新部署。

---

## 📊 两种存储方式对比

| 特性 | Firebase | Vercel KV |
|------|----------|-----------|
| **国内访问速度** | 慢（可能需要VPN） | 快（全球CDN） |
| **免费额度** | 有限 | 充足（10GB存储） |
| **数据持久化** | ✅ 是 | ✅ 是 |
| **多用户同步** | ✅ 实时同步 | ✅ 支持同步 |
| **配置难度** | 中等 | 简单 |
| **推荐场景** | 需要实时同步 | 国内用户，追求速度 |

---

## 💡 推荐方案

**如果你在国内使用，推荐切换到 Vercel KV**：
- ✅ 访问速度快
- ✅ 无需VPN
- ✅ 免费额度充足
- ✅ 配置简单

**如果已经有很多数据在 Firebase**：
- 可以先导出 Firebase 数据
- 然后切换到 Vercel KV
- 再导入数据

---

## 🔍 如何查看当前使用的存储方式

打开浏览器控制台（F12），查看日志：
- 如果看到 `📖 从Firebase读取数据` → 使用 Firebase
- 如果看到 `📖 从Vercel API读取数据` → 使用 Vercel KV

---

## ❓ 常见问题

### Q: 数据会丢失吗？
A: 不会。两种存储方式都支持数据持久化，数据不会丢失。

### Q: 可以同时使用两种存储吗？
A: 不建议。代码中只能选择一种存储方式。

### Q: 切换存储方式后，旧数据怎么办？
A: 需要手动迁移数据：
1. 从旧存储导出数据
2. 切换到新存储
3. 导入数据到新存储

### Q: Vercel KV 免费额度够用吗？
A: 够用。免费套餐提供：
- 10GB 存储空间
- 1000万次读取/月
- 100万次写入/月

对于小型比赛（<100场比赛，<50名选手）完全够用。

